<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Oscillations and Waves - 3&nbsp; Forced oscillations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_coupled_oscillators.html" rel="next">
<link href="./02_damped_oscillations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02a_forced_oscillations.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forced oscillations</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Oscillations and Waves</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/awmckinley1/oscandwaves" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Oscillations-and-Waves.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Oscillations-and-Waves.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_shm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simple Harmonic Motion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_damped_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Damped oscillations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02a_forced_oscillations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forced oscillations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_coupled_oscillators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Coupled Oscillators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_pendulums.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pendulums</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_oscillators_to_wave_motion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">From Coupled Oscillators to Wave Motion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_simple_waves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Simple wave motion and the Wave Equation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_harmonic_waves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Harmonic Waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_reflection_transmission.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reflection and Transmission at boundaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_sound_waves.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sound waves and the Doppler effect</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_superpositions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Superposition and Standing Waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_math_toolkit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Mathematical Toolkit</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-ch5-transientsolution" id="toc-sec-ch5-transientsolution" class="nav-link active" data-scroll-target="#sec-ch5-transientsolution"><span class="header-section-number">3.1</span> The Transient Solution</a></li>
  <li><a href="#sec-ch5-steadystatesolution" id="toc-sec-ch5-steadystatesolution" class="nav-link" data-scroll-target="#sec-ch5-steadystatesolution"><span class="header-section-number">3.2</span> The Steady State solution</a></li>
  <li><a href="#sec-ch5-steadystatebehaviour" id="toc-sec-ch5-steadystatebehaviour" class="nav-link" data-scroll-target="#sec-ch5-steadystatebehaviour"><span class="header-section-number">3.3</span> Steady state behaviour - Resonance</a></li>
  <li><a href="#sec-ch5-fullsolutionforcedoscillator" id="toc-sec-ch5-fullsolutionforcedoscillator" class="nav-link" data-scroll-target="#sec-ch5-fullsolutionforcedoscillator"><span class="header-section-number">3.4</span> Full solution of the forced oscillator</a>
  <ul class="collapse">
  <li><a href="#special-cases-of-forced-oscillations" id="toc-special-cases-of-forced-oscillations" class="nav-link" data-scroll-target="#special-cases-of-forced-oscillations"><span class="header-section-number">3.4.1</span> Special cases of forced oscillations</a></li>
  </ul></li>
  <li><a href="#sec-ch5-energydrivenoscillators" id="toc-sec-ch5-energydrivenoscillators" class="nav-link" data-scroll-target="#sec-ch5-energydrivenoscillators"><span class="header-section-number">3.5</span> Energy in driven oscillators</a>
  <ul class="collapse">
  <li><a href="#sec-ch5-energyinputdrivenosc" id="toc-sec-ch5-energyinputdrivenosc" class="nav-link" data-scroll-target="#sec-ch5-energyinputdrivenosc"><span class="header-section-number">3.5.1</span> Energy input for driven oscillators</a></li>
  <li><a href="#sec-ch5-energylostdrivenosc" id="toc-sec-ch5-energylostdrivenosc" class="nav-link" data-scroll-target="#sec-ch5-energylostdrivenosc"><span class="header-section-number">3.5.2</span> Energy lost in driving oscillators</a></li>
  </ul></li>
  <li><a href="#sec-ch5-impedance" id="toc-sec-ch5-impedance" class="nav-link" data-scroll-target="#sec-ch5-impedance"><span class="header-section-number">3.6</span> Impedance</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-ch5-forcedoscillations" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forced oscillations</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>Textbook link: Tipler and Mosca 14.5</em></p>
<p>In <a href="02_damped_oscillations.html"><span>Chapter&nbsp;2</span></a>) we explored the effect of damping on a system and we said that every system in the real world is, to a greater or lesser extent, a damped system in which energy is lost (dissipated) to the surroundings. In order to maintain the amplitude of any oscillation we must supply energy to the system at the same rate as it is lost to the surroundings; for example, pushing a child on a swing.</p>
<p>The equation for forced SHM is given in <a href="#eq-ch5-forcedshm1">Equation&nbsp;<span>3.1</span></a>:</p>
<p><span id="eq-ch5-forcedshm1"><span class="math display">\[
m \frac{\mathrm{d}^2 x}{\mathrm{d}t^2} + b \frac{\mathrm{d}x}{\mathrm{d}t}+ kx = F_0 \mathrm{e}^{\mathrm{i}\omega t}
\tag{3.1}\]</span></span></p>
<p>Compare this to <a href="02_damped_oscillations.html#eq-ch2-velocitydamp3">Equation&nbsp;<span>2.3</span></a> for damped SHM; we have now applied an oscillating force represented as <span class="math inline">\(F_0 \mathrm{e}^{\mathrm{i}\omega t}\)</span>, with an amplitude of <span class="math inline">\(F_0\)</span> and frequency <span class="math inline">\(\omega\)</span>. Note that this driving frequency <span class="math inline">\(\omega\)</span> is different to the natural <em>undamped</em> frequency of the oscillator, <span class="math inline">\(\omega_0 = \sqrt{\frac{k}{m}}\)</span> and different again to the frequency of the damped <em>unforced</em> oscillator, <span class="math inline">\(\omega^\prime = \sqrt{\omega_0^2 - \frac{b^2}{4m^2}}\)</span>.</p>
<p>Any forced oscillation consists of two distinct regimes:</p>
<ol type="1">
<li>An initial transient period during which the oscillations are established, and</li>
<li>A steady state period during which the oscillations have constant amplitude and a frequency equal to the driving frequency, <span class="math inline">\(\omega\)</span>.</li>
</ol>
<p>The general solution of the equation for forced SHM shown in <a href="#eq-ch5-forcedshm1">Equation&nbsp;<span>3.1</span></a> is a combination of these two regimes.</p>
<section id="sec-ch5-transientsolution" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sec-ch5-transientsolution"><span class="header-section-number">3.1</span> The Transient Solution</h2>
<p>The solution to the transient component of the forced oscillator is identical to the solution of damped SHM (<em>i.e.</em> <a href="#eq-ch5-forcedshm1">Equation&nbsp;<span>3.1</span></a> with the right-hand side set to zero; identical to <a href="02_damped_oscillations.html#eq-ch2-velocitydamp3">Equation&nbsp;<span>2.3</span></a>). Its solution is shown in <a href="#eq-ch5-forcedshm2">Equation&nbsp;<span>3.2</span></a>:</p>
<p><span id="eq-ch5-forcedshm2"><span class="math display">\[
\begin{array}{lrcl}
&amp; x &amp;=&amp; A_0 \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \mathrm{e}^{\mathrm{i} \left( \omega^\prime t + \delta^\prime \right)} \\
\textsf{or:} &amp; x &amp;=&amp; A_0 \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \cos \left( \omega^\prime t + \delta^\prime \right) \\
\end{array}
\tag{3.2}\]</span></span></p>
<p>This contribution to motion establishes the oscillation, but rapidly decays with time constant <span class="math inline">\(\tau = \frac{m}{b}\)</span>. The term <span class="math inline">\(\delta^\prime\)</span> is simply the phase constant for this transient oscillation.</p>
</section>
<section id="sec-ch5-steadystatesolution" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-ch5-steadystatesolution"><span class="header-section-number">3.2</span> The Steady State solution</h2>
<p>Once in the steady state, the energy which is put into the system during each cycle is equal to the energy dissipated per cycle due to the damping in the system. If there is no damping of the system, energy keeps being added to the system and the amplitude will increase indefinitely. This is <strong>not</strong> a steady state, and is an <strong>unphysical result</strong>. The frequency then of this ‘driven’ oscillator in the steady state is equal to the driving frequency.</p>
<p>The amplitude (and hence the energy) of the system in the steady state depends on both the <strong>amplitude</strong> and the <strong>frequency</strong> of the driving force. For a steady state, the solution to <a href="#eq-ch5-forcedshm1">Equation&nbsp;<span>3.1</span></a> is in the form shown in <a href="#eq-ch5-forcedshm3">Equation&nbsp;<span>3.3</span></a>:</p>
<p><span id="eq-ch5-forcedshm3"><span class="math display">\[
x = A \mathrm{e}^{\mathrm{i}\left(\omega t - \delta \right)}
\tag{3.3}\]</span></span></p>
<p>The terms <span class="math inline">\(A\)</span> and <span class="math inline">\(\delta\)</span> are defined in <a href="#eq-ch5-forcedshm4">Equation&nbsp;<span>3.4</span></a> and <a href="#eq-ch5-forcedshm5">Equation&nbsp;<span>3.5</span></a> below:</p>
<p><span id="eq-ch5-forcedshm4"><span class="math display">\[
A = \frac{F_0}{\sqrt{m^2 \left(\omega_0^2 - \omega^2 \right)^2 + b^2 \omega^2}}
\tag{3.4}\]</span></span></p>
<p><span id="eq-ch5-forcedshm5"><span class="math display">\[
\delta = \arctan \left( \frac{b\omega}{m \left(  \omega_0^2 - \omega^2 \right)} \right)
\tag{3.5}\]</span></span></p>
</section>
<section id="sec-ch5-steadystatebehaviour" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="sec-ch5-steadystatebehaviour"><span class="header-section-number">3.3</span> Steady state behaviour - Resonance</h2>
<p>When we vary the frequency of the driving frequency we find that the response of the driven system varies. If we examine the power transferred to the system as we vary the driving frequency, we see that there is a peak around the natural frequency, <span class="math inline">\(\omega_0\)</span>, of the driven system (<a href="#fig-ch5-resonancepowerfrequency1">Figure&nbsp;<span>3.1</span></a>). This is a phenomenon known as <strong>resonance</strong>.</p>
<div class="cell" data-layout-align="center" data-auto_pdf="true">
<div class="cell-output-display">
<div id="fig-ch5-resonancepowerfrequency1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="visualisations/ch5-forcedosc2.svg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.1: The power transferred to a system varies with the driving frequency. The power transferred to a system is proportional to <span class="math inline">\(\omega A^2\)</span>. The full-width at half-maximum value is designated <span class="math inline">\(\Delta \omega\)</span>. Note that as the damping coefficient <span class="math inline">\(b\)</span> increases, there is a shift in maximum power transmission away from the natural frequency <span class="math inline">\(\omega_0\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>If this system is damped, we also see a change in the “full-width at half-maximum” value.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> This FWHM is designated by <span class="math inline">\(\Delta \omega\)</span> in <a href="#fig-ch5-resonancepowerfrequency1">Figure&nbsp;<span>3.1</span></a> and is related to the <span class="math inline">\(Q\)</span>-factor of the system via <a href="#eq-ch5-resonancequality1">Equation&nbsp;<span>3.6</span></a>:</p>
<p><span id="eq-ch5-resonancequality1"><span class="math display">\[
\frac{\Delta \omega}{\omega_0} = \frac{1}{Q}
\tag{3.6}\]</span></span></p>
<p>This allows us to determine the <span class="math inline">\(Q\)</span>-factor of a system through measurement of resonance of the system, as a lightly-damped system (high <span class="math inline">\(Q\)</span>) will give a sharp resonance with low <span class="math inline">\(\Delta \omega\)</span>, while a more heavily damped system will lead to a more broad resonance profile.</p>
<p>This use of the <span class="math inline">\(Q\)</span>-factor is important as it give us a measure of the ‘sharpness’ (or quality) of the resonance. It may be applied to many systems including electronic circuits.</p>
<p>We can also examine the phase of the oscillator’s displacement <span class="math inline">\(x\)</span> relative to that of the driving force, <span class="math inline">\(\delta\)</span>, shown in <a href="#fig-ch5-resonancephaseshift1">Figure&nbsp;<span>3.2</span></a>.</p>
<div class="cell" data-layout-align="center" data-auto_pdf="true">
<div class="cell-output-display">
<div id="fig-ch5-resonancephaseshift1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="visualisations/ch5-forcedosc3.svg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.2: The phase shift <span class="math inline">\(\delta\)</span> of the observed oscillation varies relative to the driving frequency <span class="math inline">\(\omega\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>We can see that at low driving frequencies, there is very little phase shift between the two (the force is at a minimum when the displacement is at a minimum and is in the same direction), while at very high driving frequencies we approach a maximum phase shift of <span class="math inline">\(\pi\)</span> between the two (force still at a minimum at minimum displacement, but now the force is directed in the opposite direction to the displacement; akin to SHM). The phase change is at its most rapid when the frequency of the driving force <span class="math inline">\(\omega\)</span> is similar to the natural frequency of the oscillator (<span class="math inline">\(\omega_0\)</span>). At this point, the driving force are “in quadrature” (90<span class="math inline">\(^\circ\)</span> out of phase), with the force at a maximum when <span class="math inline">\(x\)</span> is changing most rapidly.</p>
</section>
<section id="sec-ch5-fullsolutionforcedoscillator" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sec-ch5-fullsolutionforcedoscillator"><span class="header-section-number">3.4</span> Full solution of the forced oscillator</h2>
<p>As with the damped oscillator explored in <a href="02_damped_oscillations.html"><span>Chapter&nbsp;2</span></a>, the full solution of the forced oscillator is found through the combination of the “transient state” (a free, damped system) and the “steady state” (fully forced oscillations). This is illustrated in <a href="#eq-ch5-forcedoscillfullsoln1">Equation&nbsp;<span>3.7</span></a>:</p>
<p><span id="eq-ch5-forcedoscillfullsoln1"><span class="math display">\[
\begin{array}{lrcccc}
&amp; x &amp;=&amp; \textsf{transient} &amp;+&amp;\textsf{steady state} \\
\textit{i.e.} &amp; x&amp;=&amp; A_0 \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \mathrm{e}^{\mathrm{i} \left( \omega^\prime t + \delta^\prime \right)} &amp;+&amp;  A \mathrm{e}^{\mathrm{i}\left(\omega t - \delta \right)} \\
\end{array}
\tag{3.7}\]</span></span></p>
<p>The terms in <a href="#eq-ch5-forcedoscillfullsoln1">Equation&nbsp;<span>3.7</span></a> are as follows:</p>
<ul>
<li><span class="math inline">\(\delta\)</span> is given by <a href="#eq-ch5-forcedshm5">Equation&nbsp;<span>3.5</span></a>;</li>
<li><span class="math inline">\(A\)</span> given by <a href="#eq-ch5-forcedshm4">Equation&nbsp;<span>3.4</span></a>;</li>
<li><span class="math inline">\(A_0\)</span> and <span class="math inline">\(\delta^\prime\)</span> depend on the initial conditions;</li>
<li><span class="math inline">\(\omega\)</span> is the driving frequency;</li>
<li><span class="math inline">\(\omega^\prime\)</span> is the frequency of the damped (transient) oscillations.</li>
</ul>
<p>We can simplify our view of <a href="#eq-ch5-forcedoscillfullsoln1">Equation&nbsp;<span>3.7</span></a> by applying initial conditions whereby the displacement <span class="math inline">\(x = 0\)</span> at time <span class="math inline">\(t = 0\)</span>. Therefore:</p>
<p><span class="math display">\[
0 = A_0 \mathrm{e}^{\mathrm{i} \left( \delta^\prime \right)} + A \mathrm{e}^{-\mathrm{i}\delta}
\]</span></p>
<p>…or, to rearrange, we obtain the form shown in <a href="#eq-ch5-forcedoscillfullsoln2">Equation&nbsp;<span>3.8</span></a>:</p>
<p><span id="eq-ch5-forcedoscillfullsoln2"><span class="math display">\[
A_0 = -A \mathrm{e}^{-\mathrm{i}\left( \delta + \delta^\prime \right)}
\tag{3.8}\]</span></span></p>
<p>As with any complex representation, we now compare the <strong>real</strong> and <strong>imaginary</strong> parts of the solution. Remember that <a href="#eq-ch5-forcedoscillfullsoln2">Equation&nbsp;<span>3.8</span></a> expands <em>via</em> De Moivre’s theorem to:</p>
<p><span id="eq-ch5-forcedoscillfullsoln3"><span class="math display">\[
A_0 = -A \left( \cos \left( \delta + \delta^\prime \right) + \mathrm{i} \sin \left( \delta + \delta^\prime \right)  \right)
\tag{3.9}\]</span></span></p>
<p>The imaginary component of <a href="#eq-ch5-forcedoscillfullsoln3">Equation&nbsp;<span>3.9</span></a> reduces to zero (the solution, <span class="math inline">\(A_0\)</span> is fully real):</p>
<p><span class="math display">\[
0 = -A \sin \left( \delta + \delta^\prime \right)
\]</span></p>
<p>We can therefore relate <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\delta^\prime\)</span> as follows:</p>
<p><span id="eq-ch5-forcedoscillationfullsoln4"><span class="math display">\[
\begin{array}{rcl}
\delta + \delta^\prime = \pi &amp; \textit{i.e.} &amp; \delta^\prime = \pi - \delta
\end{array}
\tag{3.10}\]</span></span></p>
<p>We now examine the ‘real’ component of <a href="#eq-ch5-forcedoscillfullsoln3">Equation&nbsp;<span>3.9</span></a>, equal to <span class="math inline">\(A_0\)</span>:</p>
<p><span class="math display">\[
A_0 = - A \cos \left( \delta + \delta^\prime \right)
\]</span></p>
<p>…and doing the same analysis, now that we know that, under our initial conditions, <span class="math inline">\(\delta + \delta^\prime = \pi\)</span>:</p>
<p><span id="eq-ch5-forcedoscillationfullsoln5"><span class="math display">\[
\begin{array}{rcl}
A_0 = -A \cos \pi &amp; \textit{i.e.} &amp; A_0 = A
\end{array}
\tag{3.11}\]</span></span></p>
<p>We can now revisit <a href="#eq-ch5-forcedoscillfullsoln1">Equation&nbsp;<span>3.7</span></a>, now that we have values for <span class="math inline">\(\delta\)</span>, <span class="math inline">\(\delta^\prime\)</span> and <span class="math inline">\(A_0\)</span> under our starting conditions ( <span class="math inline">\(x = 0\)</span> when <span class="math inline">\(t = 0\)</span>):</p>
<p><span id="eq-ch5-forcedoscillationfullsoln6"><span class="math display">\[
\begin{array}{rcl}
x &amp;= &amp; A \left[ \mathrm{e}^{\mathrm{i}\left(\omega t - \delta \right)}  + \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \mathrm{e}^{\mathrm{i} \left( \omega^\prime t + \delta^\prime \right)} \right]\\
&amp;= &amp; A \left[ \mathrm{e}^{\mathrm{i}\left(\omega t - \delta \right)}  + \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \mathrm{e}^{\mathrm{i} \left( \omega^\prime t + \pi - \delta \right)} \right]\\
&amp;= &amp; A \left[ \mathrm{e}^{\mathrm{i}\left(\omega t - \delta \right)}  + \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \mathrm{e}^{\mathrm{i} \left( \omega^\prime t - \delta \right)} \mathrm{e}^{\mathrm{i} \pi} \right]\\
&amp;= &amp; A \left[ \mathrm{e}^{\mathrm{i}\left(\omega t - \delta \right)}  - \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \mathrm{e}^{\mathrm{i} \left( \omega^\prime t - \delta \right)}  \right]\\
\end{array}
\tag{3.12}\]</span></span></p>
<p>Finally, we can find the actual displacement of the oscillator by examining the real component of <a href="#eq-ch5-forcedoscillationfullsoln6">Equation&nbsp;<span>3.12</span></a>, summarised in <a href="#eq-ch5-forcedoscillationfullsoln7">Equation&nbsp;<span>3.13</span></a>):</p>
<p><span id="eq-ch5-forcedoscillationfullsoln7"><span class="math display">\[
\mathrm{Re}(x) = A \left[ \cos (\omega t - \delta) - \mathrm{e}^{- \left(\frac{b}{2m}\right)t} \cos (\omega^\prime t - \delta) \right]
\tag{3.13}\]</span></span></p>
<p>We can visualise the amplitude of a forced oscillator, as shown in <a href="#fig-ch5-forcedoscilfull1">Figure&nbsp;<span>3.3</span></a>. At very low frequencies, the oscillation has the same amplitude as the driving oscillation. This rapidly increases under resonance to a peak, but then drops rapidly to a value towards zero.</p>
<div class="cell" data-layout-align="center" data-auto_pdf="true">
<div class="cell-output-display">
<div id="fig-ch5-forcedoscilfull1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="visualisations/ch5-forcedosc1.svg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.3: The amplitude of a forced oscillation varies with driving frequency; close to the driving amplitude at very low frequencies, close to zero at very high frequencies, with a peak occurring under resonant conditions. Note that the position of this peak varies with the damping coefficient <span class="math inline">\(b\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that the position of the resonant peak amplitude also varies with the damping coefficient <span class="math inline">\(b\)</span>.</p>
<section id="special-cases-of-forced-oscillations" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="special-cases-of-forced-oscillations"><span class="header-section-number">3.4.1</span> Special cases of forced oscillations</h3>
<p>There are three special cases of forced oscillations to consider:</p>
<ol type="1">
<li><span class="math inline">\(\omega \ll \omega_0\)</span></li>
<li><span class="math inline">\(\omega \gg \omega_0\)</span></li>
<li><span class="math inline">\(\omega = \omega_0\)</span></li>
</ol>
<div class="cell" data-layout-align="center" data-auto_pdf="true">
<div class="cell-output-display">
<div id="fig-ch5-forcedosc4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="visualisations/ch5-forcedosc4.svg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.4: When the frequency of the driving oscillation <span class="math inline">\(\omega\)</span> is very different to the natural frequency of the system we see two regimes; firstly, where <span class="math inline">\(\omega \ll \omega_0\)</span> (blue), the natural frequency decays and we are left to observe the driving frequency at a large amplitude; when <span class="math inline">\(\omega \gg \omega_0\)</span> (orange), we see a much smaller amplitude oscillation at close to the driving frequency.</figcaption>
</figure>
</div>
</div>
</div>
<p>In the special case when <span class="math inline">\(\omega = \omega_0\)</span> and the damping coefficient <span class="math inline">\(b\)</span> is small (allowing the damped frequency <span class="math inline">\(\omega^\prime\)</span> to be approximately equal to the driving frequency <span class="math inline">\(\omega\)</span>), we can rewrite the expression of the displacement (<a href="#eq-ch5-forcedoscillationfullsoln7">Equation&nbsp;<span>3.13</span></a>) as shown in <a href="#eq-ch5-forcedoscillationfullsoln8">Equation&nbsp;<span>3.14</span></a>:</p>
<p><span id="eq-ch5-forcedoscillationfullsoln8"><span class="math display">\[
\mathrm{Re}(x) = A  \cos (\omega_0 t - \delta) \left[ 1 - \mathrm{e}^{- \left(\frac{b}{2m}\right)t}  \right]
\tag{3.14}\]</span></span></p>
<p>We can see that the oscillation will converge to a maximum value, at which point the energy put into the system becomes equal to the energy dissipated by the system through damping, as shown in <a href="#fig-ch5-resonancedisplacement1">Figure&nbsp;<span>3.5</span></a>:</p>
<div class="cell" data-layout-align="center" data-auto_pdf="true">
<div class="cell-output-display">
<div id="fig-ch5-resonancedisplacement1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="visualisations/ch5-forcedosc5.svg" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3.5: When the frequency of the driving oscillation <span class="math inline">\(\omega = \omega_0\)</span> (blue), we see the amplitude grow to a plateau at which point the energy put into the system is equal to the energy losses from the system.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-ch5-energydrivenoscillators" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="sec-ch5-energydrivenoscillators"><span class="header-section-number">3.5</span> Energy in driven oscillators</h2>
<p>In a driven oscillator, energy is continually added to the system. When it reaches its steady state, the rate of loss of energy in each cycle due to damping of the system is equal to the work done by the driving force.</p>
<p>We can demonstrate this through integration; remember that (simplistically!) work done is “force <span class="math inline">\(\times\)</span> distance”, so under varying force (as we have here), we can integrate the force with respect to displacement <span class="math inline">\(x\)</span> to find an expression for the work done.</p>
<p>For the sake of convenience, we will consider the “real” component of the equation for forced SHM shown in <a href="#eq-ch5-forcedshm1">Equation&nbsp;<span>3.1</span></a> (the left-hand-side is entirely “real”, so the “imaginary” component reduces to zero anyway):</p>
<p><span id="eq-ch5-oscillatorenergy1"><span class="math display">\[
m \frac{\mathrm{d}^2 x}{\mathrm{d}t^2} + b \frac{\mathrm{d}x}{\mathrm{d}t}+ kx = F_0 \cos \omega t
\tag{3.15}\]</span></span></p>
<p>We also know that the steady state solution for the displacement <span class="math inline">\(x\)</span> in SHM is as given in <a href="01_shm.html#eq-shm-general-positionx1">Equation&nbsp;<span>1.5</span></a>. We can then find an expression for the velocity <span class="math inline">\(v\)</span> by finding the first derivative of this expression (<a href="#eq-ch5-oscillatorenergy2">Equation&nbsp;<span>3.16</span></a>):</p>
<p><span id="eq-ch5-oscillatorenergy2"><span class="math display">\[
\begin{array}{rcl}
x&amp; =&amp; A \cos (\omega t - \delta)\\
v = \dfrac{\mathrm{d}x}{\mathrm{d}t} &amp;=&amp; -\omega A \sin (\omega t - \delta)
\end{array}
\tag{3.16}\]</span></span></p>
<section id="sec-ch5-energyinputdrivenosc" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="sec-ch5-energyinputdrivenosc"><span class="header-section-number">3.5.1</span> Energy input for driven oscillators</h3>
<p>To find the energy which is put into the system over one cycle, we therefore need to find the integral of the force acting over one cycle of the oscillation, from <span class="math inline">\(t = 0\)</span> to <span class="math inline">\(t = T\)</span> (remember that <span class="math inline">\(T\)</span> is the period of the oscillation). We do this integration by substituting our variable <span class="math inline">\(\mathrm{d}x\)</span> for <span class="math inline">\(v\mathrm{d}t\)</span> (as defined in <a href="#eq-ch5-oscillatorenergy2">Equation&nbsp;<span>3.16</span></a>):</p>
<p><span class="math display">\[
\begin{array}{rcl}
E_\mathrm{in} = \displaystyle{\int_0^T} F \cdot \mathrm{d}x &amp;\equiv&amp; \displaystyle{\int_0^T} F \cdot v \mathrm{d}t \\
&amp;=&amp; \displaystyle{\int_0^T} F_0 \cos \omega t \cdot \left[ -\omega A \sin (\omega t + \delta)\right] \mathrm{d}t \\
&amp;=&amp; -\omega A F_0 \displaystyle{\int_0^T} \cos \omega t \cdot \sin (\omega t + \delta) \\
&amp;=&amp; -\omega A F_0 \displaystyle{\int_0^T} \cos \omega t \cdot \left[ \sin \omega t \cos \delta + \cos \omega t \sin \delta  \right] \\
&amp;=&amp; -\omega A F_0 \displaystyle{\int_0^T} \left[ \cos \omega t \sin \omega t \cos \delta + \cos \omega t \cos \omega t \sin \delta \right] \\
&amp;=&amp; -\omega A F_0 \displaystyle{\int_0^T} \left[ \tfrac{1}{2} \sin 2\omega t \cos \delta + \left( \tfrac{1}{2}\cos 2\omega t + \tfrac{1}{2} \right) \sin \delta \right] \\
&amp;=&amp; -\omega A F_0 \left[ -\tfrac{1}{4\omega} \cos 2\omega t \cos \delta  + \left( \tfrac{1}{4\omega}\sin 2\omega t + \tfrac{t}{2} \right)\sin \delta \right]_0^T\\
&amp;=&amp; -\omega A F_0 \left( \left[ -\tfrac{1}{4\omega} \cos 2\omega T \cos \delta  + \left( \tfrac{1}{4\omega}\sin 2\omega T + \tfrac{T}{2} \right)\sin \delta \right] - \left[ -\tfrac{1}{4\omega} \cos 0 \cos \delta  + \left( \tfrac{1}{4\omega}\sin 0 + \tfrac{0}{2} \right)\sin \delta \right] \right)  \\
\end{array}
\]</span></p>
<p>Evaluation of this integral gives us the end result shown in <a href="#eq-ch5-oscillatorenergy4">Equation&nbsp;<span>3.17</span></a>:</p>
<p><span id="eq-ch5-oscillatorenergy4"><span class="math display">\[
E_{\mathrm{in}} = \frac{1}{2}\omega A F_0 T \sin \delta
\tag{3.17}\]</span></span></p>
<p>If we recall that <span class="math inline">\(\delta = \frac{\pi}{2}\)</span> at resonance, substitution of this value into <a href="#eq-ch5-oscillatorenergy4">Equation&nbsp;<span>3.17</span></a> tells us that the maximum energy is transferred to the oscillator when driven at a resonant frequency - in line with our expectations.</p>
<p>If we now use the definition of <span class="math inline">\(\delta\)</span> in <a href="#eq-ch5-forcedshm5">Equation&nbsp;<span>3.5</span></a>, we can use trigonometry and the expression for <span class="math inline">\(A\)</span> in <a href="#eq-ch5-forcedshm4">Equation&nbsp;<span>3.4</span></a> to give the expression <span class="math inline">\(\sin \delta = \frac{Ab\omega}{F_0}\)</span>; we can also use the fact that the period of oscillation <span class="math inline">\(T\)</span> and the angular frequency <span class="math inline">\(\omega\)</span> are related by <a href="01_shm.html#eq-ch1-definingomega1">Equation&nbsp;<span>1.12</span></a> (<span class="math inline">\(T = \frac{2\pi}{\omega}\)</span>), and simplify the expression for the energy input for the forced oscillator as shown in <a href="#eq-ch5-oscillatorenergy5">Equation&nbsp;<span>3.18</span></a>:</p>
<p><span id="eq-ch5-oscillatorenergy5"><span class="math display">\[
E_{\mathrm{in}} = \pi b \omega A^2
\tag{3.18}\]</span></span></p>
</section>
<section id="sec-ch5-energylostdrivenosc" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="sec-ch5-energylostdrivenosc"><span class="header-section-number">3.5.2</span> Energy lost in driving oscillators</h3>
<p>To now determine the amount of energy, we follow a similar process as followed in <a href="#sec-ch5-energyinputdrivenosc"><span>Section&nbsp;3.5.1</span></a>. This time however we need to determine the work done by the oscillator on the damping force during one cycle. This integral is set up as follows:</p>
<p><span class="math display">\[
E_{\mathrm{lost}} = \int_0^T F v \mathrm{d}t
\]</span></p>
<p>…but this time the force is the damping force, <span class="math inline">\(F_{\mathrm{damp}} = bv\)</span>.</p>
<p><span class="math display">\[
E_{\mathrm{lost}} = \int_0^T b v^2 \mathrm{d}t
\]</span></p>
<p>As before, we have the result that <span class="math inline">\(v = -\omega A \sin(\omega t - \delta)\)</span> (<a href="#eq-ch5-oscillatorenergy2">Equation&nbsp;<span>3.16</span></a>), and following through the integration in a similar manner as in the previous section we are led to the result in <a href="#eq-ch5-oscillatorenergy6">Equation&nbsp;<span>3.19</span></a> for a <strong>driven damped oscillator</strong> at <strong>steady state</strong>.</p>
<p><span id="eq-ch5-oscillatorenergy6"><span class="math display">\[
E_{\mathrm{lost}}  = \pi b \omega A^2= E_{\mathrm{in}}
\tag{3.19}\]</span></span></p>
<p>This result should not be a surprise; at a steady state, we expect the energy lost to be equivalent to the energy put into the system, however it is nice that this is vindicated through the mathematics!</p>
<p>A similar result may be obtained for electrical systems in resonance.</p>
<p><strong>Note</strong>: When <span class="math inline">\(b = 0\)</span> the above result appears to fail (no energy is lost, but none is put in??); in fact, in an undamped system there can be no steady state (as no energy is lost!), so the amplitude of vibration <span class="math inline">\(A \rightarrow \infty\)</span>, so this result does not apply.</p>
</section>
</section>
<section id="sec-ch5-impedance" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="sec-ch5-impedance"><span class="header-section-number">3.6</span> Impedance</h2>
<p>As you learn about fields, you will examine electrical circuits and see that circuits containing capacitors and inductors are analogous to mechanical oscillators, with the electrical charge oscillating within the circuit. These properties of circuits have many important applications and you will find that much of the analysis we have done here can be applied to those electrical systems.</p>
<p>In the context of an electrical circuit it is useful to define the term <strong>impedance</strong> a measure of the opposition to the flow of current, and is defined as the ratio of the voltage to current (<span class="math inline">\(\frac{V}{I}\)</span>) for a particular circuit component. For a resistor this is simply the resistance, however capacitors and inductors also possess impedance.</p>
<p>It turns out to be helpful to write this impedance as a complex number with components in both the real and imaginary plane. This works well with the complex representation of oscillations and naturally takes care of any differences in phase of the current and voltage in different components.</p>
<p>Bringing the analogy back to mechanical oscillations, a mechanical system can also be considered to have an impedance. We define the mechanical impedance as the <strong>force required to produce unit velocity</strong>, <em>i.e.</em> <span class="math inline">\(Z_m = \frac{F}{v}\)</span>, or <span class="math inline">\(F = vZ_m\)</span>. This is the mechanical equivalent of Ohm’s law; force corresponding to the voltage, and velocity corresponding to current.</p>
<p>This idea of mechanical impedance will be useful in discussion of wave propagation.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The “full-width at half maximum” (FWHM) is a term widely used in signals processing to describe the “spread” of a signal. A large FWHM indicates a broad signal over a range of frequencies, while a small FWHM indicates a sharp signal over a narrow band of frequencies.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02_damped_oscillations.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Damped oscillations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_coupled_oscillators.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Coupled Oscillators</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>